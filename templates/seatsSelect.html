{% extends "layout.html" %}
{% block title %} Available Seats {% endblock %}
{% block body %}

<div class="container my-5">
  <div class="search-container">
    <div class="search-header">
      <h1>Select a Seat</h1>
      <p class="text-white-50">Find your perfect journey with SkyWings</p>
    </div>

    <div class="container">
      <div class="flight-info">
        <div class="info-item">
          <div class="info-label">Airline</div>
          <div class="info-value">{{ values.airline }}</div>
        </div>
        <div class="info-item">
          <div class="info-label">Flight Number</div>
          <div class="info-value">{{ values.flight_number }}</div>
        </div>
        <div class="info-item">
          <div class="info-label">Departure</div>
          <div class="info-value">{{ values.from_city }} â†’ {{ values.to_city }}</div>
        </div>
        <div class="info-item">
          <div class="info-label">Date</div>
          <div class="info-value">{{ values.departure }}</div>
        </div>
      </div>

      {% for seat_class, rows in seat_map.items() %}
        <div class="seat-map">
          <div class="row-label">{{ seat_class }} Class</div>
          <div class="seat-grid">
            {% for row_num, columns in rows.items() %}
              <div class="seat-row">
                {% set sorted_cols = columns.keys() | list | sort %}
                {% for col in sorted_cols %}
                  {% set available = columns[col] %}
                  {% set full_seat = row_num|string + col %}
                  {% set seat_classes = 'seat ' + seat_class|lower %}
                  {% if not available %}
                    {% set seat_classes = seat_classes + ' occupied' %}
                  {% endif %}
                  <div class="{{ seat_classes }}">{{ full_seat }}</div>
                {% endfor %}
              </div>
            {% endfor %}
          </div>
        </div>
      {% endfor %}

      <div class="summary-panel">
        <div class="price-summary">
          <div class="price-row">
            <span>Base Fare:</span>
            <span>
              ${{ values.economy_price if 'Economy' in seat_map else values.business_price }}
            </span>
          </div>
          <div class="price-row">
            <span>Seat Selection:</span>
            <span>$0</span>
          </div>
          <div class="price-row total-price">
            <span>Total:</span>
            <span>
              ${{ values.economy_price if 'Economy' in seat_map else values.business_price }}
            </span>
          </div>
        </div>

        <button class="confirm-btn">Confirm Selection</button>
      </div>
    </div>
  </div>
</div>

{% endblock %}